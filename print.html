<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø·Ø¨Ø§Ø¹Ø© Ù…Ù„ØµÙ‚ Ø§Ù„Ù…ÙŠØ²Ø§Ù†</title>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background: #f9f9f9; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 350px; margin: auto; border: 2px solid #1a73e8; }
        input { width: 85%; padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 20px; text-align: center; }
        .btn-main { width: 100%; padding: 18px; background: #1a73e8; color: white; border: none; border-radius: 10px; font-size: 20px; font-weight: bold; cursor: pointer; }
        #barcodeCanvas { margin-top: 15px; border: 1px solid #eee; width: 100%; }
    </style>
</head>
<body>

<div class="card">
    <h3>ØªØ¬Ù‡ÙŠØ² Ù…Ù„ØµÙ‚ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</h3>
    <input type="number" id="pCode" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù">
    <input type="number" id="pWeight" placeholder="Ø§Ù„ÙˆØ²Ù†">
    
    <button class="btn-main" onclick="saveAndPrint()">Ø­ÙØ¸ ÙˆØ·Ø¨Ø§Ø¹Ø© ÙÙˆØ±ÙŠØ© ğŸ–¨ï¸</button>
    
    <canvas id="barcodeCanvas"></canvas>
</div>

<script>
    function saveAndPrint() {
        const code = document.getElementById('pCode').value.padStart(5, '0');
        const weight = document.getElementById('pWeight').value.padStart(5, '0');
        const fullBarcode = "21" + code + weight + "0";

        // 1. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø¨Ù…Ù‚Ø§Ø³Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø·Ø§Ø¨Ø¹Ø© (58mm)
        const canvas = document.getElementById('barcodeCanvas');
        JsBarcode(canvas, fullBarcode, {
            format: "CODE128",
            displayValue: true,
            fontSize: 24,
            height: 100,
            width: 3,
            margin: 20,
            background: "#ffffff"
        });

        // 2. ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù„ØµÙˆØ±Ø© ÙˆØªØ­Ù…ÙŠÙ„Ù‡Ø§ ÙÙˆØ±Ø§Ù‹
        // Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø±ÙƒØ© ØªØ¬Ø¹Ù„ Ø§Ù„ØµÙˆØ±Ø© ØªØ¸Ù‡Ø± ÙÙŠ "Ø§Ù„ØµÙˆØ± Ø§Ù„Ø­Ø¯ÙŠØ«Ø©" Ø¯Ø§Ø®Ù„ ØªØ·Ø¨ÙŠÙ‚ iPrint
        const link = document.createElement('a');
        link.download = `barcode-${fullBarcode}.png`;
        link.href = canvas.toDataURL("image/png");
        link.click();

        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„ØµÙ‚! Ø§ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ iPrint ÙˆØ§Ø®ØªØ± 'Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙˆØ±'.");
    }
</script>
</body>
</html>
