<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 15px; border: 1px solid #ddd; max-width: 400px; margin: auto; }
        button { width: 100%; padding: 15px; margin: 10px 0; font-size: 18px; cursor: pointer; border-radius: 8px; border: none; }
        .btn-blue { background: #007bff; color: white; }
        .btn-orange { background: #e67e22; color: white; }
    </style>
</head>
<body>
<div class="card">
    <h2>Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h2>
    <button class="btn-blue" onclick="connect()">1. Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ø¨Ø¹Ø© (Bluetooth)</button>
    <button class="btn-orange" onclick="printRaw()">2. Ø·Ø¨Ø§Ø¹Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© ÙÙˆØ±ÙŠØ© ğŸ–¨ï¸</button>
</div>

<script>
    let printerCharacteristic = null;

    async function connect() {
        try {
            const device = await navigator.bluetooth.requestDevice({
                filters: [{ namePrefix: 'SC03h' }],
                optionalServices: ['0000ae30-0000-1000-8000-00805f9b34fb']
            });
            const server = await device.gatt.connect();
            const service = await server.getPrimaryService('0000ae30-0000-1000-8000-00805f9b34fb');
            printerCharacteristic = await service.getCharacteristic('0000ae01-0000-1000-8000-00805f9b34fb');
            alert("ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­!");
        } catch (e) { alert("Ø®Ø·Ø£ Ø§ØªØµØ§Ù„: " + e); }
    }

    async function printRaw() {
        if (!printerCharacteristic) return alert("Ø§Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ø¨Ø¹Ø© Ø£ÙˆÙ„Ø§Ù‹!");
        
        // Ø¥Ø±Ø³Ø§Ù„ Ù†Øµ Ø®Ø§Ù… + Ø£ÙˆØ§Ù…Ø± ØªØºØ°ÙŠØ© ÙˆØ±Ù‚ Ø¨Ø³ÙŠØ·Ø© Ø¬Ø¯Ø§Ù‹
        const encoder = new TextEncoder();
        const data = [
            new Uint8Array([0x1B, 0x40]), // ØªÙ‡ÙŠØ¦Ø©
            encoder.encode("BARCODE TEST\n123456789\n\n\n\n\n"), // Ù†Øµ Ù…Ø¹ 5 Ø³Ø·ÙˆØ± ÙØ§Ø±ØºØ©
            new Uint8Array([0x1D, 0x56, 0x01]) // Ø£Ù…Ø± Ù‚Ø·Ø¹/ØªØºØ°ÙŠØ©
        ];

        try {
            for (let chunk of data) {
                await printerCharacteristic.writeValue(chunk);
            }
            alert("ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„! Ø§Ù†Ø¸Ø± Ù„Ù„Ø·Ø§Ø¨Ø¹Ø©.");
        } catch (e) { alert("Ø®Ø·Ø£ Ø·Ø¨Ø§Ø¹Ø©: " + e); }
    }
</script>
</body>
</html>
